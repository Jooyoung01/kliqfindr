
       SUBROUTINE PRINTCOV (COVMAT,LGROUP,LMAXDEPT,DEPARTN,GLABEL,
     C  INUM,NUMTEACH,PRINTD,PRINTOFF,AVECENT,LABEL,NODIAG,TYPE,
     C  INFILE,PRINTGRP,SYMMAT)
      INCLUDE 'PARAM.H'
       REAL COVMAT(MAXGR,MAXGR),ONDIAG,AVECENT(MAXGR,1),
     C OUTCENT(MAXGR,1)
       INTEGER LGROUP(MAXKLIQ),LMAXDEPT,DEPARTN(MAXKLIQ),INUM,NUMTEACH,
     C DP,ACTG,G1,U,G2,PRINTD,PRINTOFF,NODIAG,PRINTGRP,SYMMAT,G,QI,TVAL
       REAL STATS(8,1),WK(6),XMISS(1),WT(MAXGR)
       INTEGER NBR(5),IX,IS,IER,CDNOM,AG1,AG2,ELM1,ELM2
       DOUBLE PRECISION MEAN,VAR,SKEW,MEAN2

       CHARACTER GLABEL*53
       CHARACTER LABEL(MAXKLIQ)*9,TACKON*4,INFILE*16,OUTFILE*16,TYPE*7

       OPEN(56,FILE='GROUPDIST.dl') 
       WRITE(56,33999) 'DL n=', lmaxdept
       WRITE(56,33010) 'format = edgelist1'
       WRITE(56,33010) 'data' 
       WRITE(33,3388)
       WRITE(33,3388) GLABEL
       WRITE(33,10) 'GROUP', (LGROUP(DP) , DP=1,LMAXDEPT)
       WRITE(33,8) 'LABEL',(LABEL(LGROUP(DP)) , DP=1,LMAXDEPT)
       WRITE(33,2302) 'N' , (DEPARTN(LGROUP(DP)) , DP=1,LMAXDEPT)
       WRITE(33,10) 'GROUP'

       ACTG=0
       ONDIAG=0
       CDNOM=0
       DO 76 G1=1,LMAXDEPT
       AVECENT(G1,1)=0
       OUTCENT(G1,1)=0
       IF (DEPARTN(G1) .GT. 0) THEN
       CDNOM=CDNOM+1
       END IF
00076   CONTINUE
       DO 577 AG1=1,LMAXDEPT
        G1=LGROUP(AG1)
        IF (DEPARTN(G1) .GT. 1) THEN
        ONDIAG=ONDIAG+COVMAT(AG1,AG1)
        ACTG=ACTG+1
        END IF
        IF (SYMMAT .EQ. 1) THEN

       IF (NODIAG .EQ. 1) THEN
        LASTONE=AG1-1.
       ELSE
        LASTONE=AG1
       END IF
         ELSE
        LASTONE=LMAXDEPT
         END IF
       IF ((SYMMAT .EQ. 0) .OR. (AG1 .GT. 1)) THEN
       WRITE(33,3301) G1, (COVMAT(AG1,U) ,
     C  U=1,LASTONE)
        DO 3235 QI=1,LASTONE
        IF (G1 .NE. LGROUP(QI)) THEN
        tval=INT(1000*COVMAT(AG1,QI))
        IF (TVAL .LE. 1.00) THEN
        TVAL=1
        END IF
        WRITE(56,3303) G1,LGROUP(QI),TVAL        
        END IF
03235   CONTINUE
        
C       DO 8282 U=1,LASTONE
C       WRITE(225,6262) G1, LGROUP(U),COVMAT(AG1,U)
C08282   CONTINUE
       END IF
       IF (DEPARTN(G1) .GT. 0) THEN
       DO 578 AG2=1,LMAXDEPT
         IF ((AG1 .NE. AG2) .AND. (DEPARTN(LGROUP(AG2)) .GT. 0)) THEN
C         IF (AG2 .GT. AG1) THEN
C         ELM1=AG2
C         ELM2=AG1
C         ELSE
C         ELM1=AG1
C         ELM2=AG2
C         END IF

       AVECENT(AG1,1)=AVECENT(AG1,1)+ 
     C COVMAT(AG1,AG2)/(CDNOM-1.)

       OUTCENT(AG1,1)=OUTCENT(AG1,1)+ 
     C COVMAT(AG2,AG1)/(CDNOM-1.)
       END IF
00578   CONTINUE
        END IF
00577   CONTINUE
        CLOSE(56)
       CLOSE(225)
      IF (PRINTD .EQ. 1) THEN
      WRITE(33,3308)
      WRITE(33,3308) '            DIAGONAL ELEMENTS     '
      WRITE(33,4301) 'SUM',ONDIAG
      WRITE(33,194) '/ # GROUPS','/ACTOR','/NON ISOLATE'
      WRITE(33,195) (ONDIAG/ACTG),(ONDIAG/NUMTEACH),ONDIAG/INUM
      WRITE(33,3308)
      WRITE(33,3308) 'DIAGONAL PER ACTOR'
      WRITE(33,3302) (COVMAT(U,U)/
     C DEPARTN(U), U=1,LMAXDEPT)
      WRITE(33,3308)      
      END IF
       MEAN=ONDIAG/ACTG
       VAR=0
       SKEW=0
       MEAN2=0
       OMEAN2=0
       DO 878 AG1=1,LMAXDEPT
       G=LGROUP(AG1)
       IF (DEPARTN(G) .GT. 0) THEN
       OMEAN2=OUTCENT(AG1,1)/CDNOM+OMEAN2
       MEAN2=AVECENT(AG1,1)/CDNOM+MEAN2
       END IF
       IF (DEPARTN(G) .GT. 1) THEN
       VAR=VAR+(COVMAT(AG1,AG1)-MEAN)**2/(ACTG-1.)
       SKEW=SKEW+((COVMAT(AG1,AG1)-MEAN)**3)
       END IF
00878   CONTINUE
        SKEW=0
        OPEN(56,FILE='CHECKCO')
        WRITE(56,195) SKEW,ACTG,VAR
        CLOSE(56)
        MINV=.0001
        MAXV=999999
        IF ((VAR .GT. MINV) .AND. (VAR .LT. MAXV) 
     C  .AND. (ACTG .GT. 2) .AND. (SKEW .LT. MAXV)) THEN
       SKEW=SKEW*ACTG/((ACTG-1.)*(ACTG-2.)*SQRT(VAR**3))
        END IF
      IF (PRINTD .EQ. 1) THEN
      WRITE(33,3308) '   UNIVARIATE STATISTICS ON DIAGONALS'
      WRITE(33,194) 'MEAN','VAR','STD','SKEW'
      WRITE(33,195) MEAN,VAR,VAR**.5,SKEW
      WRITE(33,3308)
      IF (PRINTGRP .EQ. 1) THEN
      OPEN(56, FILE='densemom.dat')
      WRITE(56,201) INFILE,TYPE,'ON-DIAGONAL',ACTG,MEAN,VAR,SKEW
      CLOSE(56)
      END IF
      END IF
  
      IF (PRINTOFF .EQ. 1) THEN
      WRITE(33,3308)
      WRITE(33,3308) '            OFF-DIAGONAL ELEMENTS     '      


      WRITE(33,3308) 'MEAN, IN CENTRALITY (FREEMAN''S IN-DEGREE)'
      WRITE(33,3308) 'TAKEN AT SUBGROUP LEVEL '
      WRITE(33,3302) (OUTCENT(U,1), U=1,LMAXDEPT)

      WRITE(33,3308)
      WRITE(33,3308) 'MEAN PER ACTOR'
      WRITE(33,3302) (OUTCENT(U,1)/DEPARTN(LGROUP(U)), 
     C                                  U=1,LMAXDEPT)
      WRITE(33,3308)      
       IF (SYMMAT .EQ. 0) THEN
      WRITE(33,3308) 'MEAN, OUT CENTRALITY (FREEMAN''S OUT-DEGREE)'
       WRITE(33,3308) 'TAKEN AT SUBGROUP LEVEL '
      WRITE(33,3302) (AVECENT(U,1), U=1,LMAXDEPT)

      WRITE(33,3308)
      WRITE(33,3308) 'MEAN PER ACTOR'
      WRITE(33,3302) (AVECENT(U,1)/DEPARTN(LGROUP(U)), 
     C                                  U=1,LMAXDEPT)

      WRITE(33,3308)      
      WRITE(33,3308) 'RATIO IN/OUT CENTRALITY'
      WRITE(33,3302) (OUTCENT(U,1)/AVECENT(U,1), U=1,LMAXDEPT)

      WRITE(33,3308)      
      WRITE(33,3308) 'RATIO IN/OUT CENTRALITY PER ACTOR'
      WRITE(33,3302) (OUTCENT(U,1)/(DEPARTN(LGROUP(U))*
     C AVECENT(U,1)), U=1,LMAXDEPT)
         END IF

       VAR=0
       SKEW=0
       DO 879 G=1,LMAXDEPT
       IF (DEPARTN(LGROUP(G)) .GT. 1) THEN
       VAR=VAR+(OUTCENT(G,1)-MEAN2)**2/(CDNOM-1.)
       SKEW=SKEW+((OUTCENT(G,1)-MEAN2)**3)
       END IF
00879   CONTINUE
       SKEW=SKEW*CDNOM/((CDNOM-1.)*(CDNOM-2.)*VAR**1.5)
      WRITE(33,3308)
      WRITE(33,3308) '   UNIVARIATE STATISTICS OFF-DIAGONALS'
      WRITE(33,3308) 'IN-CENTRALITY'
      WRITE(33,194) 'MEAN','VAR','STD','SKEW'
      WRITE(33,195) MEAN2,VAR,VAR**.5,SKEW
      WRITE(33,3308)
      IF (PRINTGRP .EQ. 1) THEN
      OPEN(56, FILE='densemom.dat')
      WRITE(56,201) INFILE,TYPE,'OFF-DIAGONAL-IN',ACTG,MEAN2,
     C VAR,SKEW
       CLOSE(56)
      END IF
       IF (SYMMAT .EQ. 0) THEN
       VAR=0
       SKEW=0
       DO 5879 G=1,LMAXDEPT
       IF (DEPARTN(LGROUP(G)) .GT. 1) THEN
       VAR=VAR+(AVECENT(G,1)-OMEAN2)**2/(CDNOM-1.)
       SKEW=SKEW+((AVECENT(G,1)-OMEAN2)**3)
       END IF
05879   CONTINUE
       SKEW=SKEW*CDNOM/((CDNOM-1.)*(CDNOM-2.)*VAR**1.5)
      WRITE(33,3308) '   UNIVARIATE STATISTICS OFF-DIAGONALS'
      WRITE(33,3308) 'OUT-CENTRALITY'
      WRITE(33,194) 'MEAN','VAR','STD','SKEW'
      WRITE(33,195) OMEAN2,VAR,VAR**.5,SKEW
      WRITE(33,3308)
      IF (PRINTGRP .EQ. 1) THEN
      OPEN(56, FILE='densemom.dat')
      WRITE(56,201) INFILE,TYPE,'OFF-DIAGONAL-OUT',ACTG,OMEAN2,
     C VAR,SKEW
      CLOSE(56)
      END IF
       END IF
      END IF

      RETURN
      
33999 format (A5,I3)
33010 format (A)

03303 FORMAT(3I10)
00201 FORMAT(3(A16,1X),25(G10.5,1X))
03302 FORMAT(7X,251(F7.2$))
03301 FORMAT(I6,1X,10(25F7.2/))
    8 FORMAT(10(25(A6,1X),/))
   10 FORMAT(A7,10(25(I6,1X),/))
 2302 FORMAT(A4,3X,10(25(I6,1X),/))
  194 FORMAT(10(2X,A15))
  195 FORMAT(10(2X,F15.5))  
00199 FORMAT(F10.6)
03308  FORMAT(A)
03388  FORMAT(10X,A,10X)
04301  FORMAT(A,F10.5)
04307  FORMAT(A,F10.5$)
06262  FORMAT(2I10,F10.5)
       END 
